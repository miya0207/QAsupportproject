# 「どの投稿でDMが来たか」分析設計（最小）

## 目的
- DM発生の“きっかけ投稿”を特定し、同系統の投稿を増やす
- 投稿頻度やトーンを変えずに、成果（DM）だけ改善する

## 基本方針（安全運用）
- 自動DM送信/自動フォロー等はしない
- 記録と分析のみをPythonで行う
- DM内容は個人情報を含む可能性があるため、**保存は要約/ラベルのみ**推奨

## 取るデータ（最低限）
### posts（投稿）
- post_id（XのID/URL末尾）
- posted_at（日時）
- type（共感/観点/QA例など）
- text（本文）
- impressions（表示回数）
- likes / reposts / replies
- profile_clicks（取れる場合）
- link_clicks（取れる場合）

### dms（DMイベント）
- dm_id（任意IDでOK）
- received_at（日時）
- dm_label（例：依頼/質問/雑談/価格/納期）
- dm_strength（0/1：依頼に近いか）
- note（要約1行：個人情報は入れない）

### attribution（紐づけ）
- dm_id
- post_id（最も近い“きっかけ”投稿）
- rule（紐づけルール名）

## 紐づけルール（現実的）
1) DM受信時刻から **過去48時間** に投稿があれば、その中で
   - 直近の投稿を第一候補
   - 直近5投稿を候補として保管（順位付き）
2) 手動で「この投稿がきっかけ」を選び直せる欄を用意（override）

## 週次レビュー（15分で回す）
- DMが発生した投稿タイプ上位3つ
- その投稿の“構造”を抽出（例：共感→短文→問いかけ、など）
- 次週は同構造を2本だけ増やす（やりすぎない）

## KPI（超シンプル）
- 週のDM数
- DM/投稿（DM発生率）
- 依頼DM割合（dm_strength=1 の割合）
